# WinePool - Винный маркетплейс

## Общее описание
WinePool - винный маркетплейс. Мы разрабатываем лучшую в мире винную онлайн экосистему из приложений, которая будет как магнитом притягивать покупателей со всего мира из за ее удобства, красоты, наполнения и сервиса (в том числе доставки на дом), рекламировать продукцию виноделен и приносить хорошую прибыль продавцам.

## Ключевые особенности

### 1. Интерфейс для покупателей
*   Удобный, интуитивный, минималистичный, но при этом очень привлекательный интерфейс.
*   Можно за основу взять один из вариантов популярных сервисов (WB, OZON, зарубежные аналоги) и доработать с учетом специфики винного рынка.

### 2. Сервис доставки
*   Предстоит реализовать смешанный вариант:
    *   Звезда - общий склад, с которого осуществляется доставка.
    *   Через сами магазины с их курьерами.
*   Требуется приложение для курьеров:
    *   Информация о заказе, адресе и контактах.
    *   Геолокация и построение маршрута.
    *   Отображение курьера на карте у покупателя.
    *   Сервис распознавания личности по биометрии ЕБС (Единая Биометрическая Система) для передачи товара и соблюдения законодательства.

### 3. Возможности для виноделен
*   Выделение своей продукции:
        *   Информация о винах на странице винодельни.
        *   Раздел WineWiki с расширенной информацией.
        *   Страница виноделльни с историей и достижениями.
        *   Дополнительные возможности рекламы (баннеры на главной, рекомендации).
        *   Возможности монетизации для команды разработки.

### 4. Приложение для магазина
*   Мобильная версия:
    *   Для магазина: функция сканирования марок и QR-кодов.
    *   Для покупателя: функции просмотра и покупки.
*   Десктопная версия:
    *   Для удобства регистрации и оприходования больших партий товара.
    *   Интеграция с системой ЕГАИС (Единая Государственная Автоматизированная Информационная Система).
    *   Может быть адаптированной версией мобильного приложения.

### 5. Приложение для администратора
*   Управление основными сущностями (справочниками), как мы сейчас и делаем.

## Архитектура приложения (на 31.10.2025)

### 1. Фундамент - Каталог (Роль: Администратор)
*   1.1. Управление Винодельнями (`Winery`): (Завершено).
*   1.2. Управление Винами (`Wine`): (Завершено).
*   1.3. WineWiki: Создать информационный раздел, возможно, с расширенными данными о сортах, регионах и т.д. (это можно отложить).

### 2. Основной функционал - Торговля (Роли: Продавец, Покупатель)
*   2.1. Управление Предложениями (`Offer`): (Завершено).
*   2.2. Витрина для Покупателя: (Завершено).
*   2.3. Идентификация покупателя: В связи с Российским законодательством и рассматриваемо законопроекте об онлайн продаже и доставке алкогольной продукции, покупателю для оформления доставки необходимо подтвердить личность через единую биометрическую систему (ЕБС). Таким образом, покупатель имеет право:
    *   Сделать заказ и выкупить вино в магазине (без ЕБС).
    *   С ЕБС: полностью оплатить и заказать доставку на дом.
    *   Соответственно, у покупателя должен быть личный кабинет с возможностью подтверждения своей личности через систему ЕБС (по его желанию).
*   2.4. Корзина и Заказы (`Cart`, `Order`): (Завершено).

### 3. Логистика и Доставка (Роль: Курьер)
*   3.1. Приложение для Курьера: Это, по сути, отдельный проект или очень большой модуль, который можно выделить в отдельную задачу позже. Здесь при передаче заказа также необходимо подтверждать личность через ЕБС.

### 4. Инструменты для Продавцов (Роль: Продавец)
*   4.1. Интеграция с ЕГАИС и QR-кодами: Это сложная, специфичная задача, требующая отдельного исследования.
*   4.2. Рекламные инструменты: Баннеры, рекомендации и т.д.

## Текущая задача (23.11.2025)
Интеграция с ЕБС (Единой Биометрической Системой) для подтверждения личности при доставке алкогольной продукции. Работа над устранением ошибок, связанных с версией Gradle и кэшем Android Studio, а также обеспечение корректной работы плагина ЕБС.

## Новая задача (23.11.2025)
Создание нового проекта winepool_final с обновленной версией Gradle (9.1.0), jdk-17 для улучшения совместимости и производительности сборки.

## Задача (30.11.2025)
Создание нового проекта `winepool_final` путем переноса файлов из `winepool_app` и отладка плагина `ebs_plugin`. Решение проблем с `build.gradle`, `AndroidManifest.xml`, импортами в Java и Dart. Успешный запуск плагина в `CUSTOM` режиме и вывод на экран ЕБС. Текущий статус: ожидание реальных тестовых данных от ЕБС (https://techportal-int.ebsbio.tech/).

## Задача (18.12.2025) - Интеграция ML-сервиса для распознавания этикеток вина
Добавлена функциональность распознавания текста с этикеток вина с использованием пакета `google_mlkit_text_recognition`. 

### Технические детали:
- Используется пакет `google_mlkit_text_recognition: ^0.15.0` для OCR
- Используется пакет `image_picker` для выбора изображения с камеры или галереи
- Добавлен экран `WineLabelOcrScreen` для распознавания этикеток
- Добавлен маршрут `/wine-label-ocr` в навигацию
- Добавлена кнопка доступа к функциональности в профиле пользователя
- Для Android добавлены разрешения CAMERA, WRITE_EXTERNAL_STORAGE, READ_EXTERNAL_STORAGE

### Особенности реализации:
- Используется локальное распознавание текста (без облачных API)
- Поддерживается распознавание латинского и кириллического текста
- Реализована обработка ошибок при выборе изображения и распознавании
- Добаван индикатор процесса обработки
- Текст отображается в SelectableText.rich для возможности копирования

### Доступ к функциональности:
- Доступ осуществляется через экран профиля (кнопка "Распознавание этикетки вина")
- Пользователь может выбрать изображение с камеры или из галереи
- После выбора изображения автоматически запускается процесс распознавания
- Результат отображается в нижней части экрана

Данная функциональность является первым шагом к реализации полноценного распознавания этикеток вина с извлечением структурированной информации.
