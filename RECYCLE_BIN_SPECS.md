# –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∫–æ–Ω—Ü–µ–ø—Ü–∏—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è "–º—è–≥–∫–æ" —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π (–≤–∏–Ω–æ–¥–µ–ª–µ–Ω –∏ –≤–∏–Ω) –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

## 1. –û–±—â–∞—è –∫–æ–Ω—Ü–µ–ø—Ü–∏—è

–í–º–µ—Å—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ "–ö–æ—Ä–∑–∏–Ω–∞", —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –±—É–¥–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–ø–∏—Å–∫–∏ –≤–∏–Ω–æ–¥–µ–ª–µ–Ω –∏ –≤–∏–Ω. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–º–æ–∂–µ—Ç —á–µ—Ä–µ–∑ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏–¥–∞ –≤–∫–ª—é—á–∞—Ç—å –∏ –≤—ã–∫–ª—é—á–∞—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤.

```mermaid
graph TD
    subgraph Admin Screens
        A[Screen with List] -->|Click Settings Icon| B[Show BottomSheet];
    end

    subgraph Settings BottomSheet
        C[Checkbox: "Show deleted items"] -->|On/Off| D{State Management};
    end

    D -->|Update Provider| E[Refetch List];
    E --> A;
```

## 2. UI/UX

### 2.1. –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤–∏–¥–∞

*   –ù–∞ —ç–∫—Ä–∞–Ω–∞—Ö, –≥–¥–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Å–ø–∏—Å–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `WineriesScreen`, `WinesScreen`), –≤ `AppBar` –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∏–∫–æ–Ω–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Icons.settings`).
*   –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∏–∫–æ–Ω–∫—É —Å–Ω–∏–∑—É –ø–æ—è–≤–ª—è–µ—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ (`BottomSheet`).

### 2.2. `BottomSheet` —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

*   –°–æ–¥–µ—Ä–∂–∏—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å (`SwitchListTile` –∏–ª–∏ `CheckboxListTile`) —Å —Ç–µ–∫—Å—Ç–æ–º "–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —É–¥–∞–ª–µ–Ω–Ω—ã–µ".
*   –°–æ—Å—Ç–æ—è–Ω–∏–µ —ç—Ç–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å –ø–æ–º–æ—â—å—é `StateProvider` –∏–ª–∏ `NotifierProvider` –≤ Riverpod), —á—Ç–æ–±—ã –≤—ã–±–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –±—ã–ª –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º –≤ —Ç–µ—á–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏.

### 2.3. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ —Å–ø–∏—Å–∫–µ

*   –ï—Å–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å "–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —É–¥–∞–ª–µ–Ω–Ω—ã–µ" –∞–∫—Ç–∏–≤–µ–Ω, –≤ –æ–±—â–µ–º —Å–ø–∏—Å–∫–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è —É–¥–∞–ª–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã.
*   **–í–∏–∑—É–∞–ª—å–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ**: –£–¥–∞–ª–µ–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Ç–∏–ª–∏–∑–æ–≤–∞–Ω—ã –∏–Ω–∞—á–µ, —á—Ç–æ–±—ã –ª–µ–≥–∫–æ –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –æ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö. –ù–∞–ø—Ä–∏–º–µ—Ä:
    *   –°–Ω–∏–∂–µ–Ω–Ω–∞—è –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å (Opacity).
    *   –°–µ—Ä—ã–π –∏–ª–∏ –±–ª–µ–∫–ª—ã–π —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞.
    *   –ò–∫–æ–Ω–∫–∞ –∫–æ—Ä–∑–∏–Ω—ã —Ä—è–¥–æ–º —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º.
*   **–î–µ–π—Å—Ç–≤–∏—è**: –£ –∫–∞–∂–¥–æ–≥–æ —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å".

**–ü—Ä–∏–º–µ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏ —É–¥–∞–ª–µ–Ω–Ω–æ–π –≤–∏–Ω–æ–¥–µ–ª—å–Ω–∏:**

```
+----------------------------------+
| (opacity: 0.5)                   |
| üóëÔ∏è –í–∏–Ω–æ–¥–µ–ª—å–Ω—è "–ó–∞–±—ã—Ç—ã–µ —Å–∫–ª–æ–Ω—ã"   |
|                                  |
|               [ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å ]   |
+----------------------------------+
```

**–õ–æ–≥–∏–∫–∞ –¥–ª—è –≤–∏–Ω –æ—Å—Ç–∞–µ—Ç—Å—è –ø—Ä–µ–∂–Ω–µ–π**: –µ—Å–ª–∏ –≤–∏–Ω–æ–¥–µ–ª—å–Ω—è —É–¥–∞–ª–µ–Ω–Ω–æ–≥–æ –≤–∏–Ω–∞ —Ç–∞–∫–∂–µ —É–¥–∞–ª–µ–Ω–∞, –∫–Ω–æ–ø–∫–∞ "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å" –¥–ª—è –≤–∏–Ω–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–∞ —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –ø—Ä–∏–º–µ—á–∞–Ω–∏–µ–º.

## 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤

–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –º–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –¥–æ–±–∞–≤–∏–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π.

### 3.1. `WineriesRepository`

```dart
/// lib/features/wines/data/wineries_repository.dart

// –ú–û–î–ò–§–ò–¶–ò–†–û–í–ê–¢–¨
Future<List<Winery>> fetchAllWineries({bool includeDeleted = false}) async {
  final query = _supabaseClient
      .from('wineries')
      .select('id, name, country_code, region_id, ... , countries!inner(name), regions!inner(name)')
      .order('created_at', ascending: false);

  if (!includeDeleted) {
    query.eq('is_deleted', false);
  }

  final response = await query;
  return response.map((json) => Winery.fromJson(json)).toList();
}

// –û–°–¢–ê–í–ò–¢–¨ –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô (–∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å)
Future<void> restoreWinery(String wineryId) async {
  await _supabaseClient
      .from('wineries')
      .update({'is_deleted': false})
      .eq('id', wineryId);
}
```

### 3.2. `WinesRepository`

```dart
/// lib/features/wines/data/wines_repository.dart

// –ú–û–î–ò–§–ò–¶–ò–†–û–í–ê–¢–¨
Future<List<Wine>> fetchAllWines({bool includeDeleted = false}) async {
  final query = _supabaseClient
      .from('wines')
      .select('*, wineries:winery_id(*, country:country_code(*))')
      .order('created_at', ascending: false);

  if (!includeDeleted) {
    query.eq('is_deleted', false);
  }

  final response = await query;
  return response.map((json) => Wine.fromJson(json)).toList();
}

// –û–°–¢–ê–í–ò–¢–¨ –ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô (–∏–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å)
Future<void> restoreWine(String wineId) async {
  await _supabaseClient
      .from('wines')
      .update({'is_deleted': false})
      .eq('id', wineId);
}
```
*–ê–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –≤–Ω–µ—Å—Ç–∏ –∏ –≤ –¥—Ä—É–≥–∏–µ –º–µ—Ç–æ–¥—ã –≤—ã–±–æ—Ä–∫–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, `fetchWinesByWinery`.*

## 4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º (Riverpod)

*   –°–æ–∑–¥–∞—Ç—å `NotifierProvider` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤–∏–¥–∞.

```dart
@riverpod
class AdminViewSettings extends _$AdminViewSettings {
  @override
  bool build() => false; // false = –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —É–¥–∞–ª–µ–Ω–Ω—ã–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

  void toggleShowDeleted() {
    state = !state;
  }
}
```

*   –í –≤–∏–¥–∂–µ—Ç–∞—Ö —ç–∫—Ä–∞–Ω–æ–≤ —Å–ø–∏—Å–∫–æ–≤ —á–∏—Ç–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —ç—Ç–æ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –µ–≥–æ –≤ –º–µ—Ç–æ–¥—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –¥–∞–Ω–Ω—ã—Ö.